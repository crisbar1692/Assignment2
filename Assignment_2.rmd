---
title: "Assignment 2"
output: html_document
---

This is Assignment 2 for Scientific Programing course of Systems Biology master in Maastricht University
The goal of this assignment is to create a regression model to predict the  boiling point of differente kinds of alkanes based in other properties.

The first step will be use different libraries to build this model. This will be useful to make a query about the alkanes with "wikidataQueryServiceR extract their features with rcdk, perform the regression model with "pls" and plot the results with "gplots".


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

install.packages("WikidataQueryServiceR")
install.packages("rJava")
install.packages("rcdk")
install.packages("pls")
install.packages("gplots")

library("WikidataQueryServiceR")
library("rJava")
library("rcdk")
library("pls")
```
 
 The next step is to make a query to obtain all the alkanes from wikidata with their boiling points and their smiles in order to be able to extract the features using rcdk package later.The important data extracted from wikidata will be names, boiling points, units of boiling points and smiles.
 
```{r setup, include=FALSE}

sparql_query <- 'SELECT ?comp ?compLabel ?bp ?bpUnit ?bpUnitLabel ?smiles WHERE {
  ?comp wdt:P31/wdt:P279* wd:Q41581 ;
p:P2102 [
ps:P2102 ?bp ;
psv:P2102/wikibase:quantityUnit  ?bpUnit
];
 wdt:P233 ?smiles.
SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
}'
results = query_wikidata(sparql_query)
list_alkanes            <-results[,c(2,3,5,6)]
colnames(list_alkanes)  <- c('Names','Boiling points','Units','Smiles')
print(head(list_alkanes))
```

